<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Tri par insertion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        background: #f5f6fa;
        margin: 0;
        padding: 20px;
    }

    h1 {
        font-size: 40px;
        margin-bottom: 20px;
    }

    .container {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    /* Tableau */
    .array-container {
        display: flex;
        justify-content: center;
        gap: 8px;
        flex-wrap: wrap;
        margin-bottom: 25px;
    }

    .array-item {
        padding: 6px 10px;
        font-size: 18px;
        text-align: center;
        min-width: 40px;
        border: 1px solid #ccc;
        border-radius: 6px;
        transition: 0.3s;
    }

    .current {
        background: #1565c0;
        color: white;
    }

    .compare {
        background: #f57c00;
        color: white;
    }

    .swap-highlight {
        background: #c62828;
        color: white;
    }

    /* Boutons */
    button {
        padding: 10px 18px;
        margin: 5px;
        border-radius: 8px;
        border: none;
        font-size: 18px;
        cursor: pointer;
    }

    #loadBtn { background: #2e7d32; color: white; }
    #autoBtn { background: #1565c0; color: white; }
    #stepBtn { background: #f9a825; }
    #stopBtn { background: #c62828; color: white; }

    /* Graphique */
    .bar {
        width: 55px;
        background: #2ecc71;
        border-radius: 6px;
        margin: 0 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        padding-bottom: 6px;
        color: white;
        font-size: 20px;
        font-weight: bold;
        transition: all 0.4s ease;
    }

    .bar.current {
        background: #1565c0 !important;
    }

    .bar.compare {
        background: #f57c00 !important;
    }

    .bar.swap {
        background: #e91e63 !important;
    }

    .graph-container {
        display: flex;
        justify-content: center;
        align-items: flex-end;
        height: 350px;
    }

</style>
</head>

<body>
    <div class="text-center mt-4 mb-4">
        <a href="tri.html" 
           class="btn btn-light btn-lg shadow"
           style="
                padding: 18px 40px;
                font-size: 26px;
                border-radius: 18px;
                font-weight: 600;
                color: #2c3e50;
           ">
            üè† ‚¨Ö Retour √† la page principale
        </a>
    </div>
    
    

    
    <h1>Lyc√©e Libert√© Jendouba</h1>
    <h2>Club Programmation et Intelligence Artificielle</h2>
<h2>Tri par Insertion</h2>

<div class="container">

    <!-- Tableau -->
    <div id="array" class="array-container"></div>

    <!-- Commandes -->
    <div>
        <button id="loadBtn">Charger</button>
        <button id="autoBtn">D√©marrer Auto</button>
        <button id="stepBtn">Pas √† pas</button>
        <button id="stopBtn">Arr√™ter</button>
    </div>

    <br>

    <!-- Graphique -->
    <div id="graph" class="graph-container"></div>

</div>
<div><h2>Enseignant : MEZNI Kamel</h2>
    <h3>Email : teacher.4630@tarbia.tn</h3>
    </div>
<script>
/* -----------------------------
   Variables
------------------------------*/
let values = [];
let i = 1;
let j = 1;
let key = null;
let interval = null;

/* -----------------------------
   G√©n√©ration al√©atoire
------------------------------*/
function generateRandomArray() {
    let arr = [];
    for (let k = 0; k < 10; k++) {
        arr.push(Math.floor(Math.random() * 20) + 1);
    }
    return arr;
}

/* -----------------------------
   Affichage tableau
------------------------------*/
function renderArray(highC = -1, highJ = -1, keyPos = -1) {
    const arrayDiv = document.getElementById("array");
    arrayDiv.innerHTML = "";

    values.forEach((v, idx) => {
        let item = document.createElement("div");
        item.className = "array-item";
        item.textContent = v;

        if (idx === keyPos) item.classList.add("current");
        if (idx === highJ) item.classList.add("compare");

        arrayDiv.appendChild(item);
    });
}

/* -----------------------------
   Affichage barres
------------------------------*/
function renderBars(highC = -1, highJ = -1, keyPos = -1) {
    const graph = document.getElementById("graph");
    graph.innerHTML = "";

    values.forEach((value, index) => {
        let bar = document.createElement("div");
        bar.className = "bar";
        bar.style.height = (value * 12) + "px";
        bar.textContent = value;

        if (index === keyPos) bar.classList.add("current");
        if (index === highJ) bar.classList.add("compare");

        graph.appendChild(bar);
    });
}

/* -----------------------------
   Animation d‚Äô√©change
------------------------------*/
function animateSwap(a, b) {
    return new Promise(res => {
        renderArray(a, b, i);
        renderBars(a, b, i);

        setTimeout(() => {
            [values[a], values[b]] = [values[b], values[a]];
            renderArray();
            renderBars();
            res();
        }, 500);
    });
}

/* -----------------------------
   √âtape du tri par insertion
------------------------------*/
async function insertionStep() {
    if (i >= values.length) return true;

    if (j === i) key = values[i];

    renderArray(i, j - 1, i);
    renderBars(i, j - 1, i);

    if (j > 0 && values[j - 1] > key) {
        await animateSwap(j, j - 1);
        j--;
    } else {
        i++;
        j = i;
    }

    return false;
}

/* -----------------------------
   Automatique
------------------------------*/
function startAuto() {
    if (interval) return;

    interval = setInterval(async () => {
        let done = await insertionStep();
        if (done) stop();
    }, 700);
}

function stop() {
    clearInterval(interval);
    interval = null;
}

/* -----------------------------
   Boutons
------------------------------*/
document.getElementById("loadBtn").onclick = () => {
    stop();
    i = 1;
    j = 1;
    values = generateRandomArray();
    renderArray();
    renderBars();
};

document.getElementById("autoBtn").onclick = startAuto;
document.getElementById("stopBtn").onclick = stop;

document.getElementById("stepBtn").onclick = async () => {
    stop();
    await insertionStep();
};

/* Initialisation */
values = generateRandomArray();
renderArray();
renderBars();
</script>

</body>
</html>
